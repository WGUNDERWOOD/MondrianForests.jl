var documenterSearchIndex = {"docs":
[{"location":"#MondrianForests","page":"Home","title":"MondrianForests","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Mondrian random forests in Julia","category":"page"},{"location":"#Introduction","page":"Home","title":"Introduction","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This repository provides implementations of Mondrian random forests in Julia, based on methods detailed in Cattaneo, Klusowski and Underwood, 2023, arXiv:2310:09702. This package provides:","category":"page"},{"location":"","page":"Home","title":"Home","text":"Fitting Mondrian random forests\nFitting debiased Mondrian random forests\nSelecting a lifetime parameter with polynomial estimation or generalized cross-validation","category":"page"},{"location":"#Branches","page":"Home","title":"Branches","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The main branch contains stable versions. Other branches may be unstable, and are for development purposes only.","category":"page"},{"location":"#License","page":"Home","title":"License","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"This repository and its included Julia package are licensed under GPLv3.","category":"page"},{"location":"#Julia-package","page":"Home","title":"Julia package","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"The Julia package is named MondrianForests.jl","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"From the Julia General registry:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"MondrianForests\")","category":"page"},{"location":"#Usage","page":"Home","title":"Usage","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"using MondrianForests\n\n# sample a two-dimensional Mondrian tree\nd = 2\nlambda = 2.0\ntree = MondrianTree(d, lambda)\nprintln()\nshow(tree)\nprintln()\n\n# generate some data\n# covariates X_data are two-dimensional\n# response Y_data is one-dimensional\n# true regression function is zero\nn_data = 100\ndata = MondrianForests.generate_uniform_data_uniform_errors(d, n_data)\nX_data = data[\"X\"]\nY_data = data[\"Y\"]\nprintln(\"covariates: \")\ndisplay(X_data[1:5])\nprintln(\"\\nresponses: \")\ndisplay(Y_data[1:5])\n\n# select a lifetime parameter\n# with generalized cross-validation\nn_trees = 50\nn_subsample = 30\ndebias_order = 0\nlambdas = collect(range(0.5, 10.0, step=0.5))\nlambda = select_lifetime_gcv(lambdas, n_trees, X_data, Y_data, debias_order, n_subsample)\nprintln(\"\\nlambda chosen by GCV: \", lambda)\n\n# fit and evaluate a Mondrian random forest\nx_evals = [(0.5, 0.5), (0.2, 0.8)]\nestimate_var = true\nforest = MondrianForest(lambda, n_trees, x_evals, X_data, Y_data, estimate_var)\nprintln(\"\\nestimated regression function:\")\ndisplay(forest.mu_hat)\nprintln(\"\\nestimated estimator variance:\")\ndisplay(forest.Sigma_hat)\nprintln(\"\\nestimated confidence band:\")\ndisplay(forest.confidence_band)\n\n# fit and evaluate a debiased Mondrian random forest\ndebiased_forest = DebiasedMondrianForest(lambda, n_trees, x_evals, debias_order,\n                                         X_data, Y_data, estimate_var)\nprintln(\"\\ndebiased estimated regression function:\")\ndisplay(debiased_forest.mu_hat)\nprintln(\"\\ndebiased estimated estimator variance:\")\ndisplay(debiased_forest.Sigma_hat)\nprintln(\"\\ndebiased estimated confidence band:\")\ndisplay(debiased_forest.confidence_band)","category":"page"},{"location":"#Dependencies","page":"Home","title":"Dependencies","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Distributions\nRandom\nSuppressor\nTest","category":"page"},{"location":"#Documentation","page":"Home","title":"Documentation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for the MondrianForests package is available on the web.","category":"page"},{"location":"documentation/#Documentation","page":"Documentation","title":"Documentation","text":"","category":"section"},{"location":"documentation/#Mondrian-trees","page":"Documentation","title":"Mondrian trees","text":"","category":"section"},{"location":"documentation/","page":"Documentation","title":"Documentation","text":"Modules = [MondrianForests]\nPages   = [\"tree.jl\"]\nPrivate = false","category":"page"},{"location":"documentation/#MondrianForests.MondrianTree","page":"Documentation","title":"MondrianForests.MondrianTree","text":"A Mondrian tree is determined by:\n\nid: a string to identify the tree\nlambda: the non-negative lifetime parameter\nlower: the lower coordinate of the root cell\nupper: the upper coordinate of the root cell\ncreation_time: the time when the root cell was created during sampling\nis_split: whether the root cell is split\nsplit_axis: the direction in which the root cell is split, if any\nsplit_location: the location on split_axis at which the root cell is split, if any\ntree_left: the left child tree of the root cell, if any\ntree_right: the right child tree of the root cell, if any\n\n\n\n\n\n","category":"type"},{"location":"documentation/#MondrianForests.MondrianTree-Tuple{Int64, Float64}","page":"Documentation","title":"MondrianForests.MondrianTree","text":"MondrianTree(d::Int, lambda::Float64)\n\nSample a Mondrian tree mathcalM(01^d lambda).\n\nExamples\n\nd = 2\nlambda = 3.0\ntree = MondrianTree(d, lambda);\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.MondrianTree-Union{Tuple{d}, Tuple{String, Float64, Tuple{Vararg{Float64, d}}, Tuple{Vararg{Float64, d}}, Float64}} where d","page":"Documentation","title":"MondrianForests.MondrianTree","text":"MondrianTree(id::String, lambda::Float64, lower::NTuple{d,Float64},\n             upper::NTuple{d,Float64}, creation_time::Float64) where {d}\n\nSample a Mondrian tree with a given id, lifetime, lower and upper cell coordinates, and creation time. To be used in internal construction methods.\n\nExamples\n\nid = \"\"\nlambda = 3.0\nlower = ntuple(i -> 0.2, d)\nupper = ntuple(i -> 0.7, d)\ncreation_time = 0.0\ntree = MondrianTree(id, lambda, lower, upper, creation_time)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Base.show-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"Base.show","text":"Base.show(tree::MondrianTree{d}) where {d}\n\nShow the recursive structure of a Mondrian tree.\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.are_in_same_leaf-Union{Tuple{d}, Tuple{Tuple{Vararg{Float64, d}}, Tuple{Vararg{Float64, d}}, MondrianTree}} where d","page":"Documentation","title":"MondrianForests.are_in_same_leaf","text":"are_in_same_leaf(x1::NTuple{d,Float64}, x2::NTuple{d,Float64}, tree::MondrianTree)\n\nCheck if two points are in the same leaf cell of a Mondrian tree.\n\nExamples\n\nd = 2\ntree = MondrianTree(d, 0.0)\nx1 = ntuple(i -> 0.2, d)\nx2 = ntuple(i -> 0.7, d)\nare_in_same_leaf(x1, x2, tree)\n\n# output\ntrue\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.count_leaves-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.count_leaves","text":"count_leaves(tree::MondrianTree{d}) where {d}\n\nCount the leaves of a Mondrian tree.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\ncount_leaves(tree)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_center-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.get_center","text":"get_center(tree::MondrianTree{d}) where {d}\n\nGet the center point of the root cell of a Mondrian tree.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\nget_center(tree)\n\n# output\n(0.5, 0.5)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_common_refinement-Union{Tuple{Array{MondrianTree{d}, 1}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.get_common_refinement","text":"get_common_refinement(trees::Vector{MondrianTree{d}}) where {d}\n\nGet the common refinement of several Mondrian trees, whose leaf cells are the intersections of all leaf cells in trees. Preserves the split times and returns a new equivalent MondrianTree.\n\nExamples\n\ntrees = [MondrianTree(2, 3.0) for _ in 1:3]\nrefined_tree = get_common_refinement(trees)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_leaf_containing-Union{Tuple{d}, Tuple{Tuple{Vararg{Float64, d}}, MondrianTree{d}}} where d","page":"Documentation","title":"MondrianForests.get_leaf_containing","text":"get_leaf_containing(x::NTuple{d,Float64}, tree::MondrianTree{d}) where {d}\n\nGet the leaf of a Mondrian tree containing a point x.\n\nExamples\n\nd = 2\nx = ntuple(i -> 0.2, d)\ntree = MondrianTree(d, 3.0)\nget_leaf_containing(x, tree)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_leaves-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.get_leaves","text":"get_leaves(tree::MondrianTree{d}) where {d}\n\nGet a list of the leaves in a Mondrian tree.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\nget_leaves(tree)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_subtrees-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.get_subtrees","text":"get_subtrees(tree::MondrianTree{d}) where {d}\n\nGet a list of the subtrees contained in a Mondrian tree.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\nget_subtrees(tree)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_volume-Union{Tuple{MondrianTree{d}}, Tuple{d}} where d","page":"Documentation","title":"MondrianForests.get_volume","text":"get_volume(tree::MondrianTree{d}) where {d}\n\nGet the d-dimensional volume of the root cell of a Mondrian tree.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\nget_volume(tree)\n\n# output\n1.0\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.is_in-Union{Tuple{d}, Tuple{Tuple{Vararg{Float64, d}}, MondrianTree{d}}} where d","page":"Documentation","title":"MondrianForests.is_in","text":"is_in(x::NTuple{d,Float64}, tree::MondrianTree{d}) where {d}\n\nCheck if a point x is contained in the root cell of a Mondrian tree.\n\nExamples\n\nx = ntuple(i -> 0.2, 2)\ntree = MondrianTree(2, 3.0)\nis_in(x, tree)\n\n# output\ntrue\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.restrict-Union{Tuple{d}, Tuple{MondrianTree{d}, Float64}} where d","page":"Documentation","title":"MondrianForests.restrict","text":"restrict(tree::MondrianTree{d}, time::Float64) where {d}\n\nRestrict a Mondrian tree to a stopping time.\n\nExamples\n\ntree = MondrianTree(2, 3.0)\nrestrict(tree, 2.0)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Mondrian-random-forests","page":"Documentation","title":"Mondrian random forests","text":"","category":"section"},{"location":"documentation/","page":"Documentation","title":"Documentation","text":"Modules = [MondrianForests]\nPages   = [\"forest.jl\"]\nPrivate = false","category":"page"},{"location":"documentation/#MondrianForests.MondrianForest","page":"Documentation","title":"MondrianForests.MondrianForest","text":"A Mondrian random forest is determined by:\n\nlambda: the non-negative lifetime parameter\nn_trees: the number of Mondrian trees in the forest\nn_data: the number of data points\nn_evals: the number of evaluation points\nx_evals: the evaluation points\nsignificance_level: the significance level for confidence intervals\nX_data: the covariate data\nY_data: the response data\ntrees: a list of the trees used in the forest\nmu_hat: the estimated regression function\nsigma2_hat: the estimated residual variance function\nSigma_hat: the estimated forest variance function\nconfidence_band: a confidence band for the regression function\n\n\n\n\n\n","category":"type"},{"location":"documentation/#MondrianForests.MondrianForest-Union{Tuple{d}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Bool}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Bool, Float64}} where d","page":"Documentation","title":"MondrianForests.MondrianForest","text":"MondrianForest(lambda::Float64, n_trees::Int, x_evals::Vector{NTuple{d,Float64}},\n               X_data::Vector{NTuple{d,Float64}}, Y_data::Vector{Float64},\n               estimate_var::Bool=false, significance_level::Float64=0.05) where {d}\n\nFit a Mondrian random forest to data. If estimate_var is false, do not estimate the variance or construct confidence bands. This can speed up computation significantly.\n\nExamples\n\nlambda = 3.0\nn_trees = 20\nx_evals = [(0.5, 0.5), (0.2, 0.8)]\ndata = generate_uniform_data_uniform_errors(2, 50)\nX_data = data[\"X\"]\nY_data= data[\"Y\"]\nestimate_var = true\nsignificance_level = 0.05\nforest = MondrianForest(lambda, n_trees, x_evals, X_data, Y_data,\n                        estimate_var, significance_level)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Base.show-Union{Tuple{MondrianForest{d}}, Tuple{d}} where d","page":"Documentation","title":"Base.show","text":"Base.show(forest::MondrianForest{d}) where {d}\n\nShow a Mondrian random forest.\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Debiased-Mondrian-random-forests","page":"Documentation","title":"Debiased Mondrian random forests","text":"","category":"section"},{"location":"documentation/","page":"Documentation","title":"Documentation","text":"Modules = [MondrianForests]\nPages   = [\"debias.jl\"]\nPrivate = false","category":"page"},{"location":"documentation/#MondrianForests.DebiasedMondrianForest","page":"Documentation","title":"MondrianForests.DebiasedMondrianForest","text":"A debiased Mondrian random forest is determined by:\n\nlambda: the non-negative lifetime parameter\nn_trees: the number of Mondrian trees in the forest\nn_data: the number of data points\nn_evals: the number of evaluation points\nx_evals: the evaluation points\ndebias_order: the order of debiasing to apply\nsignificance_level: the significance level for confidence intervals\nX_data: the covariate data\nY_data: the response data\ndebias_scaling: the lifetime scaling values\ndebias_coeffs: the debiasing coefficients\ntrees: a list of the trees used in the forest\nmu_hat: the estimated regression function\nsigma2_hat: the estimated residual variance function\nSigma_hat: the estimated forest variance function\nconfidence_band: a confidence band for the regression function\n\n\n\n\n\n","category":"type"},{"location":"documentation/#MondrianForests.DebiasedMondrianForest-Union{Tuple{d}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Bool}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Bool, Float64}} where d","page":"Documentation","title":"MondrianForests.DebiasedMondrianForest","text":"DebiasedMondrianForest(lambda::Float64, n_trees::Int, x_evals::Vector{NTuple{d,Float64}},\n                       debias_order::Int,\n                       X_data::Vector{NTuple{d,Float64}}, Y_data::Vector{Float64},\n                       estimate_var::Bool=false,\n                       significance_level::Float64=0.05) where {d}\n\nFit a debiased Mondrian random forest to data. If estimate_var is false, do not estimate the variance or construct confidence bands. This can speed up computation significantly.\n\nExamples\n\nlambda = 3.0\nn_trees = 20\nx_evals = [(0.5, 0.5), (0.2, 0.8)]\ndebias_order = 1\ndata = generate_uniform_data_uniform_errors(2, 50)\nX_data = data[\"X\"]\nY_data= data[\"Y\"]\nestimate_var = true\nsignificance_level = 0.05\nforest = DebiasedMondrianForest(lambda, n_trees, x_evals, debias_order, X_data, Y_data,\n                                estimate_var, significance_level)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Base.show-Union{Tuple{DebiasedMondrianForest{d}}, Tuple{d}} where d","page":"Documentation","title":"Base.show","text":"Base.show(forest::DebiasedMondrianForest{d}) where {d}\n\nShow a debiased Mondrian random forest.\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Lifetime-parameter-selection","page":"Documentation","title":"Lifetime parameter selection","text":"","category":"section"},{"location":"documentation/","page":"Documentation","title":"Documentation","text":"Modules = [MondrianForests]\nPages   = [\"lifetime_polynomial.jl\", \"lifetime_gcv.jl\"]\nPrivate = false","category":"page"},{"location":"documentation/#MondrianForests.select_lifetime_polynomial-Union{Tuple{d}, Tuple{Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}}, Tuple{Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Int64}} where d","page":"Documentation","title":"MondrianForests.select_lifetime_polynomial","text":"select_lifetime_polynomial(X_data::Vector{NTuple{d,Float64}}, Y_data::Vector{Float64},\n                           debias_order::Int=0) where {d}\n\nSelect the lifetime parameter for a (debiased) Mondrian random forest using polynomial estimation.\n\nExamples\n\ndata = generate_uniform_data_uniform_errors(2, 50)\nX_data = data[\"X\"]\nY_data= data[\"Y\"]\ndebias_order = 0\nlambda = select_lifetime_polynomial(X_data, Y_data, debias_order)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.get_gcv-Union{Tuple{d}, Tuple{Float64, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Int64, Int64}} where d","page":"Documentation","title":"MondrianForests.get_gcv","text":"get_gcv(lambda::Float64, n_trees::Int,\n        X_data::Vector{NTuple{d,Float64}}, Y_data::Vector{Float64},\n        debias_order::Int, n_subsample::Int) where {d}\n\nGet the generalized cross-validation score of a lifetime parameter lambda.\n\nExamples\n\nlambda = 3.0\nn_trees = 20\ndebias_order = 0\nn_subsample = 40\ndata = generate_uniform_data_uniform_errors(2, 50)\nX_data = data[\"X\"]\nY_data= data[\"Y\"]\nlambda = get_gcv(lambdas, n_trees, X_data, Y_data, debias_order, n_subsample)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.select_lifetime_gcv-Union{Tuple{d}, Tuple{Vector{Float64}, Int64, Array{Tuple{Vararg{Float64, d}}, 1}, Vector{Float64}, Int64, Int64}} where d","page":"Documentation","title":"MondrianForests.select_lifetime_gcv","text":"select_lifetime_gcv(lambdas::Vector{Float64}, n_trees::Int,\n                    X_data::Vector{NTuple{d,Float64}}, Y_data::Vector{Float64},\n                    debias_order::Int, n_subsample::Int) where {d}\n\nSelect the lifetime parameter for a (debiased) Mondrian random forest using generalized cross-validation.\n\nExamples\n\nlambdas = collect(range(0.5, 10.0, step=0.5))\nn_trees = 20\ndebias_order = 0\nn_subsample = 40\ndata = generate_uniform_data_uniform_errors(2, 50)\nX_data = data[\"X\"]\nY_data= data[\"Y\"]\nlambda = select_lifetime_gcv(lambdas, n_trees, X_data, Y_data, debias_order, n_subsample)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#Data-generation","page":"Documentation","title":"Data generation","text":"","category":"section"},{"location":"documentation/","page":"Documentation","title":"Documentation","text":"Modules = [MondrianForests]\nPages   = [\"data.jl\"]","category":"page"},{"location":"documentation/#MondrianForests.generate_data-Tuple{Int64, Distributions.Distribution, Distributions.Distribution, Function, Function}","page":"Documentation","title":"MondrianForests.generate_data","text":"generate_data(n::Int, X_dist::Distribution, eps_dist::Distribution,\n              mu::Function, sigma2::Function)\n\nGenerate sample data for Mondrian forest estimation.\n\nDraws n independent samples from Y = mu(X) + sigma(X) varepsilon, with X sim X_dist and varepsilon sim eps_dist.\n\nExamples\n\nn = 20\nX_dist = product_distribution([Uniform(0, 1) for _ in 1:2])\neps_dist = Uniform(-1, 1)\nmu = (x -> x[1]^2)\nsigma2 = (x -> 1 + x[2]^4)\ngenerate_data(n, X_dist, eps_dist, mu, sigma2)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.generate_uniform_data_normal_errors-Tuple{Int64, Int64}","page":"Documentation","title":"MondrianForests.generate_uniform_data_normal_errors","text":"generate_uniform_data_normal_errors(d::Int, n::Int)\n\nGenerate uniform sample data with normal errors for Mondrian forest estimation.\n\nDraws n independent samples from Y = varepsilon, with X sim mathcalU0 1 and varepsilon sim mathcalN(0 1).\n\nExamples\n\nd = 3\nn = 20\ngenerate_uniform_data_normal_errors(d, n)\n\n\n\n\n\n","category":"method"},{"location":"documentation/#MondrianForests.generate_uniform_data_uniform_errors-Tuple{Int64, Int64}","page":"Documentation","title":"MondrianForests.generate_uniform_data_uniform_errors","text":"generate_uniform_data_uniform_errors(d::Int, n::Int)\n\nGenerate uniform sample data with uniform errors for Mondrian forest estimation.\n\nDraws n independent samples from Y = varepsilon, with X sim mathcalU0 1 and varepsilon sim mathcalUbig-sqrt 3 sqrt 3big.\n\nExamples\n\nd = 3\nn = 20\ngenerate_uniform_data_uniform_errors(d, n)\n\n\n\n\n\n","category":"method"}]
}
